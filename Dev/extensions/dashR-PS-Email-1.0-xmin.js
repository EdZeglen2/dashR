void 0!==window.dashR&&dashR().addContext({name:"email",js:{message:function(e,t,s,a,n){var o={to:[]};return o.to.push(e),o.from=t,o.subject=s,o.body=a,o.isHTML=!0,o.attachments=[],o.id=null!=n?n:"dashR-email",o},config:function(e,t,s){var a={};return a.server=e,a.username=t,a.password=s,a.port=587,a.enableSSL=!0,a.timeout=4e5,a.ps="C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",a},power_shell:{send:function(e,t,s){var n="[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12;\n";for(i in n+='$smtp = new-object Net.Mail.SmtpClient("'+e.server+'", '+e.port+");\n",n+='$smtp.Credentials = New-Object System.Net.NetworkCredential("'+e.username+'", "'+e.password+'");\n',n+="$smtp.EnableSsl = $"+e.enableSSL+";\n",n+="$smtp.Timeout = "+e.timeout+";\n",n+="$Message = new-object Net.Mail.MailMessage\n",n+='$Message.From = "'+t.from+'"\n',t.to)n+='$Message.To.Add("'+t.to[i]+'");\n';for(a in n+='$Message.Subject = "'+t.subject+'"\n',n+='$Message.Body = "'+t.body+'"\n',n+="$Message.IsBodyHtml = $"+t.isHTML+"\n",t.attachments)n+="$attach_"+a+' = new-object Net.Mail.Attachment("'+t.attachments[a]+'");\n ',n+="$message.Attachments.Add($attach_"+a+");\n";n+="$smtp.Send($Message);\n";var o=s+"\\"+t.id+".ps1";dashR("file").save(o,n),dashR("system").cmd_ps(e.ps,' -executionpolicy bypass -file "'+o+'" ',5,!0)}}}});