!function(t){void 0===t.dashR&&(t.dashR=function(){var n=this;function o(n){for(e in n){var i=n[e].name;null==t[i]&&(t[i]=n[e].values)}}function r(e,n){var s=this,r=e||{};s.sharedLocation=r.sharedLocation?r.sharedLocation:"data",s.folder="",s.fileName="",s.dlg=!1,s._dialogs=new function(){var e=this;e.items=[],e.init=function(){for(var t=document.getElementsByClassName("dashR-dialog"),n=0;n<t.length;n++)e.items.push({name:t[n].getAttribute("name"),visible:!1,show:function(){this.visible=!0},hide:function(){this.visible=!1}})},e.get=function(t){var n={name:"empty",visible:!1};for(i in e.items)if(e.items[i].name==t){n=e.items[i];break}return n},e.bind=function(e,t){var n=document.getElementById("dialogs"),i=document.createElement("div");i.id=t,i.setAttribute("name",t),i.setAttribute("src",e+"\\"+t+".html"),i.setAttribute("v-if","( (app.dlg) || (app.dialog('"+t+"').visible) )"),i.className+="dashR-dialog dashR-html",n.appendChild(i)},e.dlgs=function(e){var t=e.folder;for(d in e.dialogs)this.bind(t,e.dialogs[d].name);this.init()}},s._packages=new function(){this.init=function(e,t){var n=t.folder;for(p in t.packages)this.import(e,n,t.packages[p])},this.import=function(e,t,n){var i=e.folder,s=n.name,o=n.folder,r=i+"\\"+t+"\\"+s;o&&(r=i+"\\"+o+"\\"+s);var a=dashR("file").load(r+"\\css\\"+s+"-min.css");a.length>0&&((d=document.createElement("style")).innerHTML=a,document.head.appendChild(d));var l,d,c=dashR("file").load(r+"\\js\\"+s+"-min.js");if(c.length>0){(u=document.createElement("script")).type="text/javascript";var f=c;try{u.appendChild(document.createTextNode(f)),document.body.appendChild(u)}catch(e){u.text=f,document.body.appendChild(u)}}if(n.type&&"vue"==n.type){if((l=dashR("file").load(r+"\\html\\"+s+"-template.html")).length>0){var u;(u=document.createElement("script")).id=s+"-template",u.type="text/x-template",f=l;try{u.appendChild(document.createTextNode(f)),document.body.appendChild(u)}catch(e){u.text=f,document.body.appendChild(u)}}}else(l=dashR("file").load(r+"\\html\\"+s+"-template.html")).length>0&&((d=document.createElement("template")).id=s+"-template",d.className="dashR-html",d.innerHTML=l,document.body.appendChild(d))}},s.settings=new function(){return{data:null,folder:"",init:function(e){this.folder=e,this.data=l("json").load(this.folder+"\\_settings.json",{})},value:function(e,t){return 0==arguments.length?this.data:1==arguments.length?this.data[e]:(this.data[e]=t,void this.save())},save:function(){l("json").save(this.folder+"\\_settings.json",this.data)}}},s.fMap=new l("path").map(),s.ui={pages:[],id:"",showing:"Home",show:function(e){for(p in this.pages){var t,n=this.pages[p],i=document.getElementById(n.id);null!=i&&(n.id==e?(i.style.display="block",i.style.visibility="visible",this.id=n.id,this.showing=n.name,n.menu&&(t=document.getElementById(n.menu))&&(t.style.visibility="visible")):(i.style.display="none",i.style.visibility="hidden",n.menu&&(t=document.getElementById(n.menu))&&(t.style.visibility="hidden")))}},checks:{master:function(e){var t=$("[name='mstr_"+e+"']").prop("checked"),n=$("[name='"+e+"']");$.each(n,(function(e,n){$(n).prop("checked",t)}))},checked:function(e){var t=[],n=$("[name='"+e+"']");return $.each(n,(function(e,n){if($(n).prop("checked")){var i=$(n)[0]._value;t.push(i)}})),t}}},s._elements=null,s.init=function(e,n){var i;s._elements=n,s.folder=(i=t.location,l("folder").parent(i).split("///")[1].replace(/\//g,"\\")),s.fileName=function(e){var t=e.split("///");return l("file").name(t[1])}(new String(t.location)),s.data_folder=s.folder+"\\"+s.sharedLocation,l("_shared").init(s.data_folder),s.settings.init(s.data_folder),null!=e&&(null!=e.dlgs&&s._dialogs.dlgs(e.dlgs),null!=e.enums&&o(e.enums))},s.load=function(e){null!=r&&null!=r.pkgs&&s._packages.init(s,r.pkgs),function(e,t){for(var n=0;n<t.length;n++){var i=t[n].id,s=t[n].getAttribute("name"),o=t[n].getAttribute("src"),r=t[n].getAttribute("data-menu"),a="";null!=o&&(l("file").exists(e.folder+"\\"+o)?a=l("file").load(e.folder+"\\"+o):l("file").exists(o)&&(a=l("file").load(o)));var d=document.getElementById(i);a.length>0&&(d.innerHTML=a),e.ui.pages.push({id:i,name:s,text:a,menu:r})}}(s,document.getElementsByClassName("dashR-html")),s._elements.init(),e&&e()},s.shared=function(e,t){return 0==arguments.length?l("_shared").data:1==arguments.length?l("_shared").value(e):void l("_shared").value(e,t)},s.dialog=function(e){return s._dialogs.get(e)},s.checks=function(e,t){return t?s.ui.checks.master(e):s.ui.checks.checked(e)},s.init(e,n)}n.version={name:"dashR JS Library",major:1,minor:0,patch:0,number:function(){return this.major+"."+this.minor+"."+this.patch},date:"30-SEP-2024"},n.contexts=[{name:"app",js:{_empty:function(){}}},{name:"system",js:{cmd:function(e,t,n,i){var s=5,o=!1;(arguments.length>2&&(s=n),arguments.length>3&&(o=i),l("file").exists(e))&&new ActiveXObject("wScript.Shell").Run('"'+e+'" "'+t+'"',s,o)},cmd_ps:function(e,t,n,i){var s=5,o=!1;(arguments.length>2&&(s=n),arguments.length>3&&(o=i),l("file").exists(e))&&new ActiveXObject("wScript.Shell").Run('"'+e+'" '+t,s,o)},open:function(e){new ActiveXObject("WScript.Shell").run(e)}}},{name:"json",js:{load:function(e,t){var n=t;if(l("file").exists(e)){var i=l("file").load(e);i.length>0&&(n=JSON.parse(i))}return n},save:function(e,t){l("file").save(e,JSON.stringify(t))}}},{name:"file",js:{fso:new ActiveXObject("Scripting.FileSystemObject"),exists:function(e){return this.fso.FileExists(e)},get:function(e){if(this.exists(e))return this.fso.GetFile(e)},name:function(e){return this.fso.GetBaseName(e)},ext:function(e){return this.fso.GetExtensionName(e)},load:function(e,t,n){if(!this.exists(e))return"";var s=1,o="";try{var r=this.fso.OpenTextFile(e,s);o=r.ReadAll(),r.close()}catch(e){throw new Error("dashR - file.load: "+e)}if(3==arguments.length){var a=o.split(n);for(i=0;i<a.length;i++)a[i].length>0&&t.push(a[i])}return o},save:function(e,t){var n=this.fso.CreateTextFile(e,!0);n.Write(function(e){for(var t="",n=0;n<e.length;n++)e.charCodeAt(n)<=127&&(t+=e.charAt(n));return t}(t)),n.close()},delete:function(e){this.fso.FileExists(e)&&this.fso.DeleteFile(e)},copy:function(e,t,n){var i=!0;arguments.length>2&&(i=n),this.exists(e)&&this.fso.CopyFile(e,t,i)},copy_to:function(e,t){var n=new ActiveXObject("Shell.Application"),i=n.NameSpace(e);try{i.CopyHere(t,0)}catch(e){throw new Error(e)}i=null,n=null},rename:function(e,t){if(this.exists(e)){var n=this.fso.GetFile(e);n.name=t,n=null}},download:function(e,t,n){var i=new ActiveXObject("Microsoft.XMLHTTP"),s=new ActiveXObject("ADODB.Stream");i.open("GET",e,!1),i.send(),s.type=1,s.open(),s.write(i.responseBody),s.savetofile(t,2),n&&n()}}},{name:"folder",js:{fso:new ActiveXObject("Scripting.FileSystemObject"),exists:function(e){return this.fso.FolderExists(e)},get:function(e){return this.fso.GetFolder(e)},parent:function(e){return this.fso.GetParentFolderName(e)},sub_folders:function(e,t){if(this.fso.FolderExists(e)){for(var n=this.fso.GetFolder(e),i=n.SubFolders,s=new Enumerator(i);!s.atEnd();s.moveNext()){var o=this.fso.GetFolder(s.item()).name;t.push({name:o,spec:e+"\\"+o})}delete s,s=null,i=null,n=null}},filesIn:function(){if(this.fso.FolderExists(folderspec)){new ActiveXObject("shell.application");for(var e=this.fso.GetFolder(folderspec),t=e.Files,n=new Enumerator(t);!n.atEnd();n.moveNext()){var i=n.item(),s=this.fso.GetFileName(i),o=this.fso.GetFile(i),r=this.fso.GetParentFolderName(i),a=this.fso.GetFolder(r),l={};l.name=s,l.spec=folderspec+"\\"+s,l.foldername=a.name,l.mdate=new Date(o.datelastmodified),l.ext=this.fso.GetExtensionName(folderspec+"\\"+s),l.size=this.fso.GetFile(folderspec+"\\"+s).Size,into.push(l)}delete n,n=null,t=null,e=null}},files:function(e,t){if(this.fso.FolderExists(e)){for(var n=new ActiveXObject("shell.application"),i=this.fso.GetFolder(e),s=n.NameSpace(e),o=i.Files,r=new Enumerator(o);!r.atEnd();r.moveNext()){var a=r.item(),l=this.fso.GetFileName(a),d=this.fso.GetFile(a),c=this.fso.GetParentFolderName(a),f=this.fso.GetFolder(c),u={};if(u.name=l,u.spec=e+"\\"+l,u.foldername=f.name,u.mdate=new Date(d.datelastmodified),u.ext=this.fso.GetExtensionName(e+"\\"+l),u.size=this.fso.GetFile(e+"\\"+l).Size,null!=s){var h=s.ParseName(l),m=s.GetDetailsOf(h,27);u.fileData=m}t.push(u)}delete r,r=null,o=null,i=null}},traverse:function(e,t){var n=[];for(s in this.files(e,t),this.sub_folders(e,n),n)t.push(n[s]),this.files(n[s].spec,t)},create:function(e){this.fso.FolderExists(e)?alert("Folder already exists: "+e):this.fso.CreateFolder(e)},make:function(e){this.fso.FolderExists(e)||this.fso.CreateFolder(e)},delete:function(e){this.fso.FolderExists(e)?this.fso.DeleteFolder(e,!0):alert("Unable to locate and delete folder: "+e)},copy:function(e,t,n){var i=!0;arguments.length>2&&(i=n),this.fso.CopyFolder(e,t,i)},copy_to:function(e,t){var n=new ActiveXObject("Shell.Application"),i=n.NameSpace(e),s=n.NameSpace(t).Items();try{i.CopyHere(s,0)}catch(e){throw new Error(e)}i=null,n=null},move_to:function(e,t){try{if(!l("file").exists(e))throw new Error("dashR (file.move_to) File Not Found: "+e);var n=new ActiveXObject("Shell.Application"),i=new Object;if(null==(i=n.NameSpace(t)))throw new Error("dashR (file.move_to) Folder Not Found: "+t);i.MoveHere(e,16)}catch(e){throw new Error(e)}},browse:function(e,t){var n=null,i="Please select a folder ...";null!=t&&(i=t);var s=new ActiveXObject("Shell.Application").BrowseForFolder(0,i,0,e);return null!=s&&(n=s.Items().Item().path),n}}},{name:"_shared",js:{data:null,folder:"",init:function(e){this.folder=e;var t=l("json").load(this.folder+"\\_shared.json",{_shared:{}});this.data=t._shared},value:function(e,t){return 0==arguments.length?this.data:1==arguments.length?this.data[e]:(this.data[e]=t,void this.save())},save:function(){var e={_shared:this.data};l("json").save(this.folder+"\\_shared.json",e)}}},{name:"string",js:{pad:function(e,t,n,i){var s="left";if(arguments.length>3&&(s=i.toLowerCase()),"left"==s.toLowerCase()){for(var o=new String(e);o.length<n;)o=t+o;return o}for(o=new String(e);o.length<n;)o+=t;return o},left:function(e,t){return t<=0?"":t>String(e).length?e:String(e).substring(0,t)},right:function(e,t){if(t<=0)return"";if(t>String(e).length)return e;var n=String(e).length;return String(e).substring(n,n-t)},proper_case:function(e){return"string"!=typeof e?"":e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}}},{name:"path",js:{combine:function(e){var t="";for(a in e){var n=e[a].trim();if(n.length>0){var i=l("string").left(n,1),s=l("string").right(n,1);"\\"==i&&(n=n.replace(/\\/,"")),"\\"==s&&(n=n.substr(0,n.length-1)),n=n.replace(/\//,""),a>0?t+="\\"+n:t=n}}return t},relative:function(e,t){var n=e,s=t.split("..\\");for(i in s)""==s[i]&&(n=l("folder").parent(n));return n+"\\"+s[s.length-1]},map:function(e){var t=this;return t.obj={},t.for=function(e,n){if(1==arguments.length)return this.obj[e];2==arguments.length&&(t.obj[e]=n)},t}}}],n._elements=new function(){return{items:[],init:function(){for(var e=document.getElementsByTagName("dashR"),t=0;t<e.length;t++){del=e[t];var n={id:del.id,context:del.getAttribute("context"),name:del.getAttribute("name"),type:del.getAttribute("type"),value:del.getAttribute("value"),obj:void 0};l(n.context)&&(n.obj=new l(n.context)[n.type](n)),this.items.push(n)}},get:function(e){var t=null;for(i in this.items)if(this.items[i].name==e){t=this.items[i].obj;break}return t}}};var l=function(e){if(null==e)return{addContext:function(e){var t=!1;for(c in n.contexts)if(n.contexts[c].name==e.name){t=!0;break}if(t)throw new Error("dashR Context [ name:"+e.name+" ] already exists");n.contexts.push(e),e.enums&&o(e.enums)},versionInfo:function(){return n.version},newApp:function(e){return new r(e,n._elements)},el:function(e){return n._elements.get(e)}};for(c in n.contexts)if(n.contexts[c].name==e)return n.contexts[c].js};return l}())}(window);